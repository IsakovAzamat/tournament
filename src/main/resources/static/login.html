<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Вход MLBB</title>
  <style>
    :root{
      --bg1:#0b1020;
      --bg2:#0a0f1a;
      --card:rgba(255,255,255,.06);
      --text:#f3f4f6;
      --muted:#a7b0c0;
      --border:rgba(255,255,255,.14);
      --shadow: 0 20px 60px rgba(0,0,0,.55);
      --accent:#fbbf24;
      --accent2:#f59e0b;
      --ok:#34d399;
      --bad:#fb7185;
      --radius: 18px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family:var(--font);
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 15% 10%, rgba(251,191,36,.25), transparent 55%),
        radial-gradient(900px 500px at 85% 15%, rgba(99,102,241,.20), transparent 55%),
        radial-gradient(900px 500px at 50% 90%, rgba(34,197,94,.14), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      display:flex;
      align-items:center;
      justify-content:center;
      padding:28px 14px;
    }
    .wrap{ width:min(460px, 100%); }
    .brand{
      display:flex; align-items:center; justify-content:center; gap:12px;
      margin-bottom:18px; user-select:none;
    }
    .logo{
      width:40px;height:40px;border-radius:14px;
      background: linear-gradient(135deg, rgba(251,191,36,.95), rgba(245,158,11,.95));
      box-shadow: 0 10px 30px rgba(251,191,36,.22);
      position:relative; overflow:hidden;
    }
    .logo:before{
      content:""; position:absolute; inset:-40%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.55), transparent 55%);
      transform: rotate(18deg);
    }
    .brand h1{ font-size:18px; margin:0; letter-spacing:.2px; color: rgba(255,255,255,.92); }
    .brand span{ display:block; font-size:12px; color: var(--muted); margin-top:2px; }

    .card{
      background: linear-gradient(180deg, var(--card), rgba(255,255,255,.03));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      overflow:hidden;
    }
    .cardHeader{
      padding:22px 22px 14px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(255,255,255,.05), transparent);
    }
    .cardHeader h2{ margin:0; font-size:20px; letter-spacing:.2px; }
    .cardHeader p{ margin:8px 0 0; color: var(--muted); font-size:13px; line-height:1.35; }

    form{ padding:18px 22px 22px; }
    .field{ margin:12px 0; }
    label{ display:block; font-size:12px; color: rgba(255,255,255,.78); margin:0 0 6px; }
    .control{ position:relative; }
    input{
      width:100%;
      padding:12px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(10,15,26,.55);
      color: var(--text);
      outline:none;
      font-size:14px;
      transition: border .15s ease, box-shadow .15s ease;
    }
    input::placeholder{ color: rgba(167,176,192,.65); }
    input:focus{
      border-color: rgba(251,191,36,.55);
      box-shadow: 0 0 0 4px rgba(251,191,36,.14);
    }
    .toggle{
      position:absolute; right:10px; top:50%;
      transform:translateY(-50%);
      border:0; background: transparent;
      color: rgba(255,255,255,.75);
      padding:6px 8px;
      border-radius: 10px;
      cursor:pointer;
      font-size:12px;
      transition: background .15s ease, color .15s ease;
    }
    .toggle:hover{ background: rgba(255,255,255,.08); color: rgba(255,255,255,.92); }

    .btn{
      width:100%;
      margin-top:14px;
      padding:12px 14px;
      border:0;
      border-radius: 14px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color:#1b1302;
      font-weight: 800;
      letter-spacing:.2px;
      cursor:pointer;
      transition: transform .08s ease, filter .15s ease, box-shadow .15s ease, opacity .15s ease;
      box-shadow: 0 14px 30px rgba(245,158,11,.20);
    }
    .btn:hover{ filter: brightness(1.02); }
    .btn:active{ transform: translateY(1px); }
    .btn[disabled]{ opacity:.65; cursor:not-allowed; box-shadow:none; }

    .msg{
      margin:14px 0 0;
      padding:10px 12px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      font-size:13px;
      line-height:1.35;
      display:none;
    }
    .msg.ok{ display:block; border-color: rgba(52,211,153,.28); background: rgba(52,211,153,.08); color: rgba(209,250,229,.95); }
    .msg.bad{ display:block; border-color: rgba(251,113,133,.28); background: rgba(251,113,133,.08); color: rgba(255,228,230,.95); }

    .row{ display:flex; align-items:center; justify-content:space-between; margin-top:14px; gap:12px; flex-wrap:wrap; }
    .link{
      color: rgba(255,255,255,.78);
      text-decoration:none;
      font-size:13px;
      transition: color .15s ease, text-decoration-color .15s ease;
    }
    .link:hover{ color: rgba(255,255,255,.95); text-decoration:underline; text-decoration-color: rgba(255,255,255,.35); }

    .footerNote{ margin-top:14px; text-align:center; color: rgba(167,176,192,.75); font-size:12px; }
    @media (prefers-reduced-motion: reduce){ *{ transition:none !important; scroll-behavior:auto !important; } }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="brand" aria-hidden="true">
      <div class="logo"></div>
      <div>
        <h1>MLBB Portal</h1>
        <span>Войдите, чтобы продолжить</span>
      </div>
    </div>

    <div class="card">
      <div class="cardHeader">
        <h2>Вход</h2>
        <p>Введите email и пароль. Если аккаунта ещё нет — можно создать за минуту.</p>
      </div>

      <form onsubmit="event.preventDefault(); login();">
        <div class="field">
          <label for="email">Email</label>
          <div class="control">
            <input type="email" id="email" placeholder="name@example.com" autocomplete="email" required />
          </div>
        </div>

        <div class="field">
          <label for="password">Пароль</label>
          <div class="control">
            <input type="password" id="password" placeholder="Ваш пароль" autocomplete="current-password" required />
            <button class="toggle" type="button" id="togglePwd" aria-label="Показать пароль">Показать</button>
          </div>
        </div>

        <button class="btn" id="submitBtn" type="submit">Войти</button>

        <div class="msg" id="msg" role="status" aria-live="polite"></div>

        <div class="row">
          <a class="link" href="/register.html">Нет аккаунта? Создать</a>
        </div>

        <div class="footerNote">Если возникли проблемы со входом — проверьте правильность email и пароля.</div>
      </form>
    </div>
  </div>

<script>
  const msg = document.getElementById('msg');
  const submitBtn = document.getElementById('submitBtn');
  const pwd = document.getElementById('password');
  const togglePwd = document.getElementById('togglePwd');

  togglePwd.addEventListener('click', () => {
    const isHidden = pwd.type === 'password';
    pwd.type = isHidden ? 'text' : 'password';
    togglePwd.textContent = isHidden ? 'Скрыть' : 'Показать';
    togglePwd.setAttribute('aria-label', isHidden ? 'Скрыть пароль' : 'Показать пароль');
    pwd.focus();
  });

  function setMsg(type, text){
    msg.className = 'msg ' + (type || '');
    msg.textContent = text || '';
    msg.style.display = text ? 'block' : 'none';
  }

  async function login() {
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;

    setMsg('', '');
    submitBtn.disabled = true;
    submitBtn.textContent = 'Входим…';

    try {
      const formData = new URLSearchParams();
      formData.append('username', email);
      formData.append('password', password);

      const response = await fetch('/api/auth/login', {
        method: 'POST',
        body: formData
      });

      if (response.ok) {
        window.location.href = '/dashboard.html';
        setMsg('ok', 'Вы вошли! Можно делать защищенные запросы.');
      } else {
        setMsg('bad', 'Неверный логин или пароль');
      }
    } catch (e) {
      setMsg('bad', 'Ошибка сети. Проверьте подключение и попробуйте снова.');
    } finally {
      submitBtn.disabled = false;
      submitBtn.textContent = 'Войти';
    }
  }
</script>
</body>
</html>
